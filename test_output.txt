F
======================================================================
FAIL: test_e2e_signing (tests.test_e2e.TestE2E.test_e2e_signing)
End-to-End test for signing a PDF
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Volumes/HDD2/github/pdf-signature/tests/test_e2e.py", line 81, in test_e2e_signing
    self.assertEqual(result.returncode, 0, f"Script failed with code {result.returncode}")
AssertionError: 1 != 0 : Script failed with code 1

----------------------------------------------------------------------
Ran 1 test in 2.574s

FAILED (failures=1)
Starting E2E test on Darwin...
Input: /Volumes/HDD2/github/pdf-signature/tests/input_files
Output: /Volumes/HDD2/github/pdf-signature/tests/output_files
Cert: /Volumes/HDD2/github/pdf-signature/key/certificado.pfx
STDOUT: 
STDERR: [2025-12-06 17:54:32] [INFO] Found AutoFirma JAR: /Applications/AutoFirma.app/Contents/Resources/JAR/AutoFirma.jar
[2025-12-06 17:54:32] [INFO] Using AutoFirma command: java -jar /Applications/AutoFirma.app/Contents/Resources/JAR/AutoFirma.jar
[2025-12-06 17:54:32] [INFO] Found 1 PDF files to process.
[2025-12-06 17:54:32] [INFO] No alias provided. Attempting to auto-detect alias...
[2025-12-06 17:54:33] [INFO] Using alias: 1
[2025-12-06 17:54:33] [INFO] Executing: java -jar /Applications/AutoFirma.app/Contents/Resources/JAR/AutoFirma.jar sign -i /Volumes/HDD2/github/pdf-signature/tests/input_files/test_doc.pdf -o /Volumes/HDD2/github/pdf-signature/tests/output_files/test_doc-signed.pdf -store pkcs12:/Volumes/HDD2/github/pdf-signature/key/certificado.pfx -password axel2007 -format pades -alias 1 -location Madrid -reason Document validation
[2025-12-06 17:54:33] [ERROR] Failed to sign: test_doc.pdf
[2025-12-06 17:54:33] [ERROR] Output file was NOT created at: /Volumes/HDD2/github/pdf-signature/tests/output_files/test_doc-signed.pdf
[2025-12-06 17:54:33] [ERROR] Exit Code: 255
[2025-12-06 17:54:33] [ERROR] Stderr: 
[2025-12-06 17:54:33] [ERROR] Stdout: No se reconoce el parametro -location
Sintaxis: AutoFirma sign [opciones...]

Opciones:
  -gui			 (Realiza la operacion con entorno grafico. Tiene prioridad sobre -certgui)
  -certgui		 (Usa un dialogo grafico para la seleccion del certificado de firma)
  -i inputfile		 (Ruta del fichero de entrada)
  -o outputfile		 (Ruta del fichero de salida)
  -algorithm algo	 (Algoritmo de firma)
  -format		 (Establece el formato de firma)
  	 auto		 (Seleccion de formato en base al fichero de entrada)
  	 cades		 (Formato CAdES)
  	 pades		 (Formato PAdES)
  	 xades		 (Formato XAdES)
  	 facturae	 (Firma de factura electronica)
  	 ooxml		 (Formato OOXML)
  	 odf		 (Formato ODF)
  -config extraParams	 (Properties en texto plano con la configuracion de la operacion)
  -store		 (Establece el almacen de claves. Por defecto, el del sistema)
  	 auto		 (Almacen de claves del sistema)
  	 windows	 (Almacen de claves de Windows)
  	 mac		 (Almacen de claves de macOS)
  	 mozilla	 (Almacen de claves de Mozilla Firefox)
  	 dni		 (DNI electronico)
  	 pkcs12:p12file	 (Almacen PKCS#12. "p12file" es la ruta del almacen)
  	 pkcs11:p11file	 (Almacen PKCS#11. "p11file" es la ruta del controlador)
  -password password	 (Establece la contrasena del almacen)
  -alias alias		 (Alias del certificado de firma)
  -filter filter	 (Filtro para seleccionar el certificado de firma)
  -xml			 (Formatea la respuesta como XML)

[2025-12-06 17:54:33] [INFO] Signing process completed.
[2025-12-06 17:54:33] [INFO] Total: 1, Success: 0, Failed: 1

